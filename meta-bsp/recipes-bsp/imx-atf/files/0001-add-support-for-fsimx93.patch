From fdb699b5501a28b3f1907f8012ac635a57d36e60 Mon Sep 17 00:00:00 2001
From: Anatol Derksen <derksen@fs-net.de>
Date: Fri, 26 Jan 2024 13:33:19 +0100
Subject: Add support for fsimx93

Add support for fsimx93
- use lpuart1 for debug console

diff --git a/plat/imx/imx93/imx93_bl31_setup.c b/plat/imx/imx93/imx93_bl31_setup.c
index 77004ddaa..18d411972 100644
--- a/plat/imx/imx93/imx93_bl31_setup.c
+++ b/plat/imx/imx93/imx93_bl31_setup.c
@@ -72,6 +72,7 @@ static uint32_t get_spsr_for_bl33_entry(void)
 void bl31_early_platform_setup2(u_register_t arg0, u_register_t arg1,
 		u_register_t arg2, u_register_t arg3)
 {
+#if DEBUG_CONSOLE
 	static console_t console;
 
 	console_lpuart_register(IMX_LPUART_BASE, IMX_BOOT_UART_CLK_IN_HZ,
@@ -79,7 +80,7 @@ void bl31_early_platform_setup2(u_register_t arg0, u_register_t arg1,
 
 	/* This console is only used for boot stage */
 	console_set_scope(&console, CONSOLE_FLAG_BOOT);
-
+#endif
 	/*
 	 * tell BL3-1 where the non-secure software image is located
 	 * and the entry state information.
diff --git a/plat/imx/imx93/include/platform_def.h b/plat/imx/imx93/include/platform_def.h
index 9bbee908f..5be367611 100644
--- a/plat/imx/imx93/include/platform_def.h
+++ b/plat/imx/imx93/include/platform_def.h
@@ -61,7 +61,9 @@
 #define MAX_MMAP_REGIONS		17
 #endif
 
-#define IMX_LPUART_BASE			0x44380000
+#define DEBUG_CONSOLE			0
+
+#define IMX_LPUART_BASE			0x44390000
 #define IMX_BOOT_UART_CLK_IN_HZ		24000000 /* Select 24MHz oscillator */
 #define IMX_CONSOLE_BAUDRATE		115200
 
